select [project],
    [province],
    [pendingTeam],
    [location],
    [site],
    [tech],
    [kpiZStatus],
    [kpiZDate],
    [ranState],
    [rssvDate],
    [intActDate],
    [integrationStatus],
    [fullyIntegratedDate]
from CM_Table

select 

[Date],
substring([ElementID1],1,8) as "Site",
avg([downlink_resource_block_utilization%])[downlink_resource_block_utilization%],
avg([MAX_Downlink_Resource_Block_Utilization%])[MAX_Downlink_Resource_Block_Utilization%],
avg([MAX_Uplink_Resource_Block_Utilization%])[MAX_Uplink_Resource_Block_Utilization%],
avg([5G_Cell_Availability_Rate%])[5G_Cell_Availability_Rate%],
avg([uplink_resource_block_utilization%])[uplink_resource_block_utilization%],
avg([EN_DC_SCG_setup_attempts_initiated_by_MeNodeB_sr%])[EN_DC_SCG_setup_attempts_initiated_by_MeNodeB_sr%],
avg([EN_DC_Setup_Sucess_Rate_Captured_in_gNodeb%])[EN_DC_Setup_Sucess_Rate_Captured_in_gNodeb%],
avg([Random_Access_success_rate_captured_in_gNodeB%])[Random_Access_success_rate_captured_in_gNodeB%],
avg([Random_Acess_SR2])[Random_Acess_SR2],
avg([Endc_drop_rate%])[Endc_drop_rate%],
avg([SCG_Active_Radio_Resource_Retainability_Captured_in_gNodeB%])[SCG_Active_Radio_Resource_Retainability_Captured_in_gNodeB%],
avg([Timing_Advance_meter])[Timing_Advance_meter],
avg([SINR_for_PUSCH_dB])[SINR_for_PUSCH_dB],
avg([SINR_for_PUCCH_format_2_dB])[SINR_for_PUCCH_format_2_dB],
avg([SINR_for_PUCCH_format_0_dB])[SINR_for_PUCCH_format_0_dB],
avg([SINR_for_PUCCH_dB])[SINR_for_PUCCH_dB],
avg([Average_power_headroom_dB])[Average_power_headroom_dB],
avg([Average_MCS_Table2_uplink_up_to_256QAM])[Average_MCS_Table2_uplink_up_to_256QAM],
avg([Average_MCS_Table2_Downlink_up_to_256QAM])[Average_MCS_Table2_Downlink_up_to_256QAM],
avg([Average_MCS_Table1_uplink_up_to_64QAM])[Average_MCS_Table1_uplink_up_to_64QAM],
avg([Average_MCS_Table1_Downlink_up_to_64QAM])[Average_MCS_Table1_Downlink_up_to_64QAM],
avg([Average_Downlink_RLC_Delay_Time_ms])[Average_Downlink_RLC_Delay_Time_ms],
avg([downlink_MAC_contention_delay_microseconds])[downlink_MAC_contention_delay_microseconds],
avg([uplink_MAC_contention_delay_microseconds])[uplink_MAC_contention_delay_microseconds],
avg([noise_&_interference_on_push_dBm_per_PRB])[noise_&_interference_on_push_dBm_per_PRB],
avg([Available_Downlink_Resource_Block_Symbols_Percentage%])[Available_Downlink_Resource_Block_Symbols_Percentage%],
avg([Available_Uplink_Resource_Block_Symbols_Percentage%])[Available_Uplink_Resource_Block_Symbols_Percentage%],
sum([MAC_Total_Traffic_DRB+SRB_GByte])[MAC_Total_Traffic_DRB+SRB_GByte],
sum([MAC_DL_Traffic_DRB+SRB_GByte])[MAC_DL_Traffic_DRB+SRB_GByte],
sum([MAC_UL_Traffic_DRB+SRB_GByte])[MAC_UL_Traffic_DRB+SRB_GByte],
sum([Average_Number_of_RRC_Connected_ENDC_NSA])[Average_Number_of_RRC_Connected_ENDC_NSA],
sum([Max_Number_of_active_UEs_Dl])[Max_Number_of_active_UEs_Dl],
sum([Max_Number_of_active_UEs_Ul])[Max_Number_of_active_UEs_Ul],
sum([max_number_of_allocated_ue_contexts])[max_number_of_allocated_ue_contexts],
sum([Max_Number_of_RRC_Connected_ENDC_NSA])[Max_Number_of_RRC_Connected_ENDC_NSA],
sum([Max_Number_of_RRC_Connected_SA])[Max_Number_of_RRC_Connected_SA],
sum([Number_of_active_UEs_Dl])[Number_of_active_UEs_Dl],
sum([Number_of_active_UEs_Ul])[Number_of_active_UEs_Ul],
sum([Available_Downlink_Resource_Block_Symbols])[Available_Downlink_Resource_Block_Symbols],
sum([Available_Uplink_Resource_Block_Symbols])[Available_Uplink_Resource_Block_Symbols],
sum([Available_Uplink+Downlink_Resource_Block_Symbols])[Available_Uplink+Downlink_Resource_Block_Symbols],
sum([Average_Uplink_MAC_User_Throughput_Mbps]*[MAC_UL_Traffic_DRB+SRB_GByte])/sum([MAC_UL_Traffic_DRB+SRB_GByte])[Average_Uplink_MAC_User_Throughput_Mbps],
sum([Average_Downlink_MAC_User_Throughput_Mbps]*[MAC_DL_Traffic_DRB+SRB_GByte])/sum([MAC_DL_Traffic_DRB+SRB_GByte])[Average_Downlink_MAC_User_Throughput_Mbps],
sum([Average_DL_MAC_Cell_Throughput_considering_traffic(Mbps)]*[MAC_DL_Traffic_DRB+SRB_GByte])/sum([MAC_DL_Traffic_DRB+SRB_GByte])[Average_DL_MAC_Cell_Throughput_considering_traffic(Mbps)],
sum([Average_DL_MAC_Cell_Throughput_considering_actual_PDSCH_slot_onl]*[MAC_DL_Traffic_DRB+SRB_GByte])/sum([MAC_DL_Traffic_DRB+SRB_GByte])[Average_DL_MAC_Cell_Throughput_considering_actual_PDSCH_slot_onl]


 from  Ericsson_5G_Daily 

where  [MAC_UL_Traffic_DRB+SRB_GByte]!=0 and [MAC_DL_Traffic_DRB+SRB_GByte]!=0 and [Date]>=(GETDATE()-8) and substring([ElementID1],1,8) in ('MA1N0217',
'GL1N0255',
'GL1N0004',
'GL1N0205',
'GL1N0219',
'GL1N0260',
'MA1N0190',
'MA1N0101',
'MA1N0112',
'MA1N0044',
'MA1N0011',
'MA1N0008',
'GL1N0225',
'GN1N0076',
'MA1N0369',
'GN1N0261',
'GN1N0063',
'GL1N0042',
'GL1N0265',
'MA1N0098',
'MA1N0007',
'MA1N0099',
'GL1N0215',
'MA1N0034',
'GL1N0032',
'MA1N0336',
'MA1N0012',
'MA1N0133',
'GL1N0005',
'GL1N0002',
'MA1N0869',
'MA1N0201',
'GL1N0212',
'MA1N0200',
'GL1N0761',
'GN1N0584',
'GL1N0338',
'GL1N0011',
'GN1N0251',
'MA1N0729',
'MA1N0304',
'MA1N0115',
'GL1N0001',
'MA1N0125',
'MA1N0606',
'MA1N0659',
'GL1N0023',
'MA1N0119',
'MA1N0689',
'GN1N0018',
'GL1N0331',
'GN1N0455',
'GL1N0062',
'GL1N0751',
'GL1N0017',
'GL1N0110',
'MA1N0035',
'MA1N0680',
'MA1N0300',
'GN1N0048',
'MA1N0616',
'GN1N0010',
'GL1N0018',
'MA1N0149',
'MA1N0058',
'MA1N0049'
)
group by
[Date],
substring([ElementID1],1,8)